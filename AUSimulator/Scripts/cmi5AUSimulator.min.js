function GetAuthToken(){return jq.support.cors=!0,jq.ajax({async:!1,url:fetchUrl,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(n){var t=typeof n["error-code"];if(t=="string"){alert("error-code "+n["error-code"]+": "+n["error-text"]);return}t=typeof n["auth-token"];t=="string"?(jq("#txtAuthToken").val(n["auth-token"]),MarkSuccess("btnAuthToken"),MarkNext("btnState")):alert("Invalid structure returned: "+n.toString())}).fail(function(n,t,i){alert(i)}),!1}function GetStateApi(){return jq.support.cors=!0,jq.ajax({async:!0,url:"Handlers/Getcmi5StateDocument.ashx?endpoint="+endPoint+"&activityId="+activityId+"&actor="+actor+"&registration="+registration+"&token="+jq("#txtAuthToken").val(),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(n){var t,i;if(n.ErrorCode!="0")return alert("error-code "+n.ErrorCode+": "+n.ErrorText),!1;t=JSON.parse(n.StateDocument);sessionId=t.contextTemplate.extensions["http://purl.org/xapi/cmi5/context/extensions/sessionid"];i=typeof t.returnURL;i=="string"&&(returnUrl=t.returnURL);masteryScore=t.masteryScore;jq("#spnMasteryScore").html("Mastery = "+masteryScore.toString());jq("#txtState").val(JSON.stringify(t,null,4));MarkSuccess("btnState");MarkNext("btnStatement")}).fail(function(n,t,i){alert(i)}),!1}function GoLMS(){return typeof returnUrl=="string"&&returnUrl.length>0?(document.location.href=returnUrl,!1):(self.close(),!1)}function MarkNext(n){jq("#"+n).removeClass("btn-success btn-default").addClass("btn-primary")}function MarkSuccess(n){jq("#"+n).removeClass("btn-primary btn-default").addClass("btn-success")}function SendStatement(){var n=jq("input:radio[name='rdoVerb']:checked").val(),t=jq("#txtScore").val(),i=jq("input:radio[name='rdoSuccess']:checked").val(),r=jq("input:radio[name='rdoComplete']:checked").val(),u=jq("#durationHours").val()+":"+jq("#durationMinutes").val()+":"+jq("#durationSeconds").val(),f=jq("#input_progress").val();return jq.ajax({async:!0,url:"Handlers/Sendcmi5Statement.ashx?endpoint="+endPoint+"&activityId="+activityId+"&actor="+actor+"&registration="+registration+"&token="+jq("#txtAuthToken").val()+"&sessionId="+sessionId+"&score="+t+"&verb="+n+"&success="+i+"&complete="+r+"&duration="+u+"&progress="+f,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(t){if(t.HasError==1){alert(t.ErrorMessage);return}n=="Terminated"&&(MarkSuccess("btnStatement"),MarkNext("btnLMS"));jq("#spnVerbsSent").append(n+"<br/>")}).fail(function(n,t,i){alert(i)}),!1}function parse(n){var i="Not found",t=[];return n=n.toUpperCase(),location.search.substr(1).split("&").forEach(function(r){t=r.split("=");t[0].toUpperCase()===n&&(i=decodeURIComponent(t[1]))}),i}$(function(){endPoint=parse("endpoint");fetchUrl=parse("fetch");registration=parse("registration");activityId=parse("activityid");actor=parse("actor");jq=$;jq("input:radio[name='rdoVerb']").change(function(){var n=jq(this).val();n=="Initialized"&&(jq("input:radio[name='rdoComplete'][value='']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='']").prop("checked",!0));n=="Completed"&&(jq("input:radio[name='rdoComplete'][value='true']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='']").prop("checked",!0));n=="Passed"&&(jq("input:radio[name='rdoComplete'][value='']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='true']").prop("checked",!0));n=="Failed"&&(jq("input:radio[name='rdoSuccess'][value='false']").prop("checked",!0),jq("input:radio[name='rdoComplete'][value='false']").prop("checked",!0));n=="Terminated"&&jq("#durationMinutes").val("1")})});
//# sourceMappingURL=cmi5AUSimulator.min.js.map
